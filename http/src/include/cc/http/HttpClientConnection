/*
 * Copyright (C) 2007-2017 Frank Mertens.
 *
 * Distribution and use is allowed under the terms of the zlib license
 * (see cc/LICENSE-zlib).
 *
 */

#pragma once

#include <cc/http/HttpConnection>
#include <cc/http/HttpClientSocket>
#include <cc/http/HttpResponse>

namespace cc {
namespace http {

class HttpClientConnection: public HttpConnection
{
public:
    static Ref<HttpClientConnection> open(HttpClientSocket *socket);

    const SocketAddress *address() const { return socket_->address(); }

    bool isSecure() const;

    Ref<HttpResponse> readResponse();

private:
    HttpClientConnection(HttpClientSocket *socket);

    void readFirstLine(LineSource *source, HttpMessage *message) override;

    Ref<HttpClientSocket> socket_;
};

}} // namespace cc::http
