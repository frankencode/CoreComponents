/*
 * Copyright (C) 2020 Frank Mertens.
 *
 * Distribution and use is allowed under the terms of the GNU General Public License version 3
 * (see CoreComponents/LICENSE-gpl-3.0).
 *
 */

#pragma once

#include <cc/Stream>

namespace cc {

/** \class StreamTap cc/StreamTap
  * \ingroup streams
  * \brief Bi-directional traffic redirection and duplication
  * \see StreamMultiplexer
  */
class StreamTap final: public Stream
{
public:
    /** Create a null object
      */
    StreamTap() = default;

    /** Create a new stream tap
      * \param stream Data stream to tap into
      * \param inboundTap %Input tap: receives everything read from \a stream as a write (pass Stream{} to omit tapping into the reads)
      * \param outboundTap %Output tap: receives everything written to \a stream as a write (pass Stream{} to omit tapping into the writes)
      */
    StreamTap(const Stream &stream, const Stream &inboundTap, const Stream &outboundTap);

    /** Get the underlying stream
      */
    Stream stream() const;

private:
    struct State;

    State &me();
    const State &me() const;
};

} // namespace cc
