/*
 * Copyright (C) 2007-2017 Frank Mertens.
 *
 * Distribution and use is allowed under the terms of the zlib license
 * (see cc/LICENSE-zlib).
 *
 */

#pragma once

#include <cc/string>

namespace cc {
namespace net {
namespace base64 {

string encode(const string &source);
string decode(const string &source);

/** \brief Base64 decoding failed: broken input
  */
class DecodeError {
public:
    ~DecodeError() throw() {}
};

class IllegalInputSize4Error: public DecodeError {
public:
    ~IllegalInputSize4Error() throw() {}

    virtual string message() const {
        return "Base-64 error: input size need to be a multiple of 4 bytes";
    }
};

class IllegalPaddingError: public DecodeError {
public:
    ~IllegalPaddingError() throw() {}

    virtual string message() const {
        return "Base-64 error: unsupported padding";
    }
};

class IllegalCharacterError: public DecodeError {
public:
    ~IllegalCharacterError() throw() {}

    virtual string message() const {
        return "Base-64 error: illegal symbol";
    }
};

}}} // namespace cc::net::base64
