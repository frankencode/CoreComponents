ADD_DEFINITIONS(
	-D_REENTRANT
	-D_FILE_OFFSET_BITS=64
)

IF(CMAKE_SYSTEM_NAME STREQUAL "SunOS")
	ADD_DEFINITIONS(-D_POSIX_PTHREAD_SEMANTICS)
	SET(PONA_BUILD64 ON CACHE BOOL "Build 64 bit version of libPONA.")
	IF(PONA_BUILD64)
		SET(CMAKE_CXX_FLAGS "-m64 ${CMAKE_CXX_FLAGS}")
		SET(CMAKE_SHARED_LINKER_FLAGS "-m64 ${CMAKE_SHARED_LINKER_FLAGS}")
		SET(CMAKE_EXE_LINKER_FLAGS "-m64 ${CMAKE_EXE_LINKER_FLAGS}")
	ENDIF(PONA_BUILD64)
ELSEIF(CMAKE_SYSTEM_NAME STREQUAL "Darwin")
	IF(CMAKE_SYSTEM_VERSION GREATER 9.7.9)
		ADD_DEFINITIONS(-D_XOPEN_SOURCE)
	ENDIF(CMAKE_SYSTEM_VERSION GREATER 9.7.9)
	SET(CMAKE_SHARED_LINKER_FLAGS "-U_undefined -undefined dynamic_lookup ${CMAKE_SHARED_LINKER_FLAGS}")
	SET(PONA_BUILD64 ON CACHE BOOL "Build 64 bit version of libPONA.")
	IF(PONA_BUILD64)
		SET(CMAKE_CXX_FLAGS "-m64 ${CMAKE_CXX_FLAGS}")
		SET(CMAKE_SHARED_LINKER_FLAGS "-m64 ${CMAKE_SHARED_LINKER_FLAGS}")
		SET(CMAKE_EXE_LINKER_FLAGS "-m64 ${CMAKE_EXE_LINKER_FLAGS}")
	ELSE(PONA_BUILD64)
		SET(CMAKE_CXX_FLAGS "-m32 ${CMAKE_CXX_FLAGS}")
		SET(CMAKE_SHARED_LINKER_FLAGS "-m32 ${CMAKE_SHARED_LINKER_FLAGS}")
		SET(CMAKE_EXE_LINKER_FLAGS "-m32 ${CMAKE_EXE_LINKER_FLAGS}")
	ENDIF(PONA_BUILD64)
ELSEIF(CMAKE_SYSTEM_NAME STREQUAL "Linux")
	ADD_DEFINITIONS(-D_XOPEN_SOURCE=600)
ELSE(CMAKE_SYSTEM_NAME STREQUAL "SunOS")
ENDIF(CMAKE_SYSTEM_NAME STREQUAL "SunOS")
SET(CMAKE_CXX_FLAGS_DEBUG "-Wall ${CMAKE_CXX_FLAGS_DEBUG}")

IF(CMAKE_SYSTEM_NAME STREQUAL "SunOS")
	LINK_LIBRARIES(pthread socket nsl)
ELSEIF(CMAKE_SYSTEM_NAME STREQUAL "Darwin")
	LINK_LIBRARIES(pthread)
ELSEIF(CMAKE_SYSTEM_NAME STREQUAL "Linux")
	LINK_LIBRARIES(pthread rt util)
ELSE(CMAKE_SYSTEM_NAME STREQUAL "SunOS")
	LINK_LIBRARIES(pthread util)
ENDIF(CMAKE_SYSTEM_NAME STREQUAL "SunOS")

SET(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/build CACHE PATH "")
SET(EXECUTABLE_OUTPUT_PATH ${PROJECT_BINARY_DIR}/build CACHE PATH "")

IF(BUILD_SHARED_LIBS)
	ADD_DEFINITIONS(-DPONA_SHARED_LIBRARY)
	SET(CMAKE_CXX_FLAGS "-fvisibility=hidden -fvisibility-inlines-hidden ${CMAKE_CXX_FLAGS}")
ENDIF(BUILD_SHARED_LIBS)

# MESSAGE("CMAKE_SYSTEM_PROCESSOR = ${CMAKE_SYSTEM_PROCESSOR}")
# MESSAGE("CMAKE_HOST_SYSTEM_PROCESSOR = ${CMAKE_HOST_SYSTEM_PROCESSOR}")
