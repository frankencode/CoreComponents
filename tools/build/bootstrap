#!/bin/sh -ex
SOURCE=$1
MACHINE=$(gcc -dumpmachine)
mkdir -p .modules-5CF18B7A-$MACHINE-Core_src
mkdir -p .modules-13029BBC-$MACHINE-Syntax_src
mkdir -p .modules-E43B5248-$MACHINE-Glob_src
mkdir -p .modules-CED283DB-$MACHINE-Meta_src
mkdir -p .modules-46002B89-$MACHINE-tools_build
g++ -c -o .modules-5CF18B7A-$MACHINE-Core_src/.lump.o -DNDEBUG -O0 -fPIC -Wall -pthread -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden -DCCBUILD_BUNDLE_VERSION=2.1.1 -D_GNU_SOURCE -Wno-psabi -std=c++20 -I$SOURCE/Core/src/include $SOURCE/Core/src/.lump.cc &
g++ -c -o .modules-13029BBC-$MACHINE-Syntax_src/.lump.o -DNDEBUG -O0 -fPIC -Wall -pthread -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden -DCCBUILD_BUNDLE_VERSION=2.1.1 -D_GNU_SOURCE -std=c++20 -Wno-psabi -I$SOURCE/Syntax/src/include -I$SOURCE/Core/src/include $SOURCE/Syntax/src/.lump.cc &
g++ -c -o .modules-E43B5248-$MACHINE-Glob_src/.lump.o -DNDEBUG -O0 -fPIC -Wall -pthread -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden -DCCBUILD_BUNDLE_VERSION=2.1.1 -D_GNU_SOURCE -std=c++20 -Wno-psabi -I$SOURCE/Glob/src/include -I$SOURCE/Core/src/include -I$SOURCE/Syntax/src/include $SOURCE/Glob/src/.lump.cc &
g++ -c -o .modules-CED283DB-$MACHINE-Meta_src/.lump.o -DNDEBUG -O0 -fPIC -Wall -pthread -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden -DCCBUILD_BUNDLE_VERSION=2.1.1 -D_GNU_SOURCE -std=c++20 -Wno-psabi -I$SOURCE/Meta/src/include -I$SOURCE/Core/src/include -I$SOURCE/Syntax/src/include $SOURCE/Meta/src/.lump.cc &
g++ -c -o .modules-46002B89-$MACHINE-tools_build/.lump.o -DNDEBUG -O0 -fPIC -Wall -pthread -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden -DCCBUILD_BUNDLE_VERSION=2.1.1 -D_GNU_SOURCE -std=c++20 -Wno-psabi -I$SOURCE/tools/build/include -I$SOURCE/Core/src/include -I$SOURCE/Glob/src/include -I$SOURCE/Meta/src/include $SOURCE/tools/build/.lump.cc &
wait
g++ -o libCoreComponentsCore.so.2.1.1 -shared -pthread -Wl,-soname,libCoreComponentsCore.so.2 .modules-5CF18B7A-$MACHINE-Core_src/.lump.o -fPIC -O0 -L. -ldl -Wl,--enable-new-dtags,-rpath='$ORIGIN',-rpath='$ORIGIN'/../lib,-rpath-link='$ORIGIN'
rm -f libCoreComponentsCore.so.2.1
rm -f libCoreComponentsCore.so.2
rm -f libCoreComponentsCore.so
ln -sf libCoreComponentsCore.so.2.1.1 libCoreComponentsCore.so.2.1
ln -sf libCoreComponentsCore.so.2.1.1 libCoreComponentsCore.so.2
ln -sf libCoreComponentsCore.so.2.1.1 libCoreComponentsCore.so
g++ -o libCoreComponentsSyntax.so.2.1.1 -shared -pthread -Wl,-soname,libCoreComponentsSyntax.so.2 .modules-13029BBC-$MACHINE-Syntax_src/.lump.o -fPIC -O0 -L. -lCoreComponentsCore -Wl,--enable-new-dtags,-rpath='$ORIGIN',-rpath='$ORIGIN'/../lib,-rpath-link='$ORIGIN'
rm -f libCoreComponentsSyntax.so.2.1
rm -f libCoreComponentsSyntax.so.2
rm -f libCoreComponentsSyntax.so
ln -sf libCoreComponentsSyntax.so.2.1.1 libCoreComponentsSyntax.so.2.1
ln -sf libCoreComponentsSyntax.so.2.1.1 libCoreComponentsSyntax.so.2
ln -sf libCoreComponentsSyntax.so.2.1.1 libCoreComponentsSyntax.so
g++ -o libCoreComponentsMeta.so.2.1.1 -shared -pthread -Wl,-soname,libCoreComponentsMeta.so.2 .modules-CED283DB-$MACHINE-Meta_src/.lump.o -fPIC -O0 -L. -lCoreComponentsCore -lCoreComponentsSyntax -Wl,--enable-new-dtags,-rpath='$ORIGIN',-rpath='$ORIGIN'/../lib,-rpath-link='$ORIGIN' &
rm -f libCoreComponentsMeta.so.2.1
rm -f libCoreComponentsMeta.so.2
rm -f libCoreComponentsMeta.so
ln -sf libCoreComponentsMeta.so.2.1.1 libCoreComponentsMeta.so.2.1
ln -sf libCoreComponentsMeta.so.2.1.1 libCoreComponentsMeta.so.2
ln -sf libCoreComponentsMeta.so.2.1.1 libCoreComponentsMeta.so
g++ -o libCoreComponentsGlob.so.2.1.1 -shared -pthread -Wl,-soname,libCoreComponentsGlob.so.2 .modules-E43B5248-$MACHINE-Glob_src/.lump.o -fPIC -O0 -L. -lCoreComponentsCore -lCoreComponentsSyntax -Wl,--enable-new-dtags,-rpath='$ORIGIN',-rpath='$ORIGIN'/../lib,-rpath-link='$ORIGIN' &
rm -f libCoreComponentsGlob.so.2.1
rm -f libCoreComponentsGlob.so.2
rm -f libCoreComponentsGlob.so
ln -sf libCoreComponentsGlob.so.2.1.1 libCoreComponentsGlob.so.2.1
ln -sf libCoreComponentsGlob.so.2.1.1 libCoreComponentsGlob.so.2
ln -sf libCoreComponentsGlob.so.2.1.1 libCoreComponentsGlob.so
wait
g++ -o ccbuild -pthread .modules-46002B89-$MACHINE-tools_build/.lump.o -fPIC -pie -O0 -L. -lCoreComponentsCore -lCoreComponentsGlob -lCoreComponentsMeta -Wl,--enable-new-dtags,-rpath='$ORIGIN',-rpath='$ORIGIN'/../lib,-rpath-link='$ORIGIN'
